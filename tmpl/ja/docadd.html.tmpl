[% PROCESS global/header.html.tmpl %]

[% IF added.defined %]
  <h3>'[% full_path FILTER html %]' にドキュメント [% added FILTER html %] が追加されました</h3>
[% ELSE %]
  <h3>新しいドキュメントの追加</h3>
  <form action="docadd.cgi" name="docadd_set" method="POST" enctype="multipart/form-data">
    [% PROCESS global/formopt.html.tmpl %]
    <ul>
      <li>新しいドキュメントの名前: <tt>
        [%- IF pid == -1 %]
          <select name="pid" onChange="AllPathChange();">
            <option value="0">/</option>
            [% FOREACH hid IN allpath.keys.nsort %]
              <option value="[% hid %]">/[% allpath.$hid.fullpath %]</option>
            [%- END %]
          </select>
        [% ELSE %]
          <input type="hidden" name="pid" value="[% path_info.pathid %]">
          [% full_path FILTER html %]
        [% END -%]
        /</tt><input type="text" name="filename" value="" size="50"></li>
      <li>新しいドキュメントの説明: <input type="text" name="docdesc" value="" size="150"></li>
      <li>セキュリティーフラグを設定する (ダウンロード時に暗号化): <input type="checkbox" name="secure" /></li>
    </ul>
    <h4>新規ドキュメントに付けるラベル</h4>
    <ul>
      [% FOREACH item = Label.keys %]
        <li><input type="checkbox" name="label" value="[% item %]" />
          [% Label.$item.name %] ([% Label.$item.description %])</li>
      [% END %]
    </ul>
    [% INCLUDE entry/docform.html.tmpl %]
    <input type="submit" value="Add document">
    <input type="reset" value="Reset">
  </form>
[% END %]

<hr>

<ul>
  <li>ディレクトリの説明: 
    <a id="hidurl" href="pathinfo.cgi?pid=[% path_info.pathid FILTER html %]"><span id="fullpath">[% full_path FILTER html %]</span> (<span id="hid">[% path_info.pathid FILTER html %]</span>)</a> - <span id="desc">[% path_info.description FILTER html %]</span></li>
  [% IF pid == -1 %]
    <li>アクセス可能グループ: 
      [% IF group_list.size > 0 %][% group_list.join(', ') %]
      [% ELSE %](未定義)[% END %]</li>
  [% END %]
</ul>

[% IF pid != -1 %]
  [% INCLUDE entry/table.html.tmpl       paths = path_list
                                         docs = doc_list 
                                         cpname = full_path %]
[% END %]
[% IF pid == -1 %]
  <script type="text/javascript" src="json.cgi?format=js&amp;type=allpath"></script>
  <script type="text/javascript"><!--
    AllPathChange();
  --></script>
[% END %]
[% PROCESS global/footer.html.tmpl %]
